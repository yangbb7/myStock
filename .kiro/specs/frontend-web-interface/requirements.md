# 前端Web交互界面需求文档

## 项目概述

为myQuant模块化单体量化交易系统开发一个现代化的Web前端界面，提供直观的用户交互体验。该系统采用模块化单体架构，具有超低延迟（微秒级）、强一致性和高性能特点，支持策略管理、实时监控、数据分析和系统控制等核心功能。

### 系统架构特点
- **模块化单体架构**: 6个核心模块（数据、策略、执行、风险、投资组合、分析）
- **超低延迟**: 内存调用延迟0.1-1ms，适合高频交易
- **强一致性**: 单进程内事务，避免分布式事务复杂性
- **高性能优化**: 对象池、缓存机制、批处理、异步处理
- **完整API**: 基于FastAPI的RESTful接口，支持实时WebSocket

## 功能需求

### 需求1：系统仪表板

**用户故事：** 作为量化交易用户，我希望有一个综合仪表板，以便快速了解系统整体状态和关键指标。

#### 验收标准

1. WHEN 用户访问主页 THEN 系统应调用 `/health` 和 `/metrics` API显示实时系统状态（运行/停止）
2. WHEN 系统运行时 THEN 仪表板应调用 `/portfolio/summary` API显示当前投资组合价值、现金余额、持仓数量等关键指标
3. WHEN 系统有告警时 THEN 仪表板应调用 `/risk/metrics` API突出显示风险警告和系统异常
4. WHEN 用户查看仪表板 THEN 系统应显示6个核心模块（数据、策略、执行、风险、投资组合、分析）的健康状态和运行时间
5. WHEN 数据更新时 THEN 仪表板应通过定时轮询API或WebSocket连接实时刷新显示最新信息
6. WHEN 用户需要系统控制 THEN 仪表板应提供 `/system/start` 和 `/system/stop` 操作按钮

### 需求2：策略管理界面

**用户故事：** 作为策略开发者，我希望能够通过Web界面管理我的交易策略，以便方便地创建、配置、启动和监控策略。

#### 验收标准

1. WHEN 用户访问策略页面 THEN 系统应调用 `/strategy/performance` API显示所有已配置策略的列表和状态
2. WHEN 用户创建新策略 THEN 系统应提供策略配置表单，包含策略名称、股票代码、初始资金、风险容忍度、最大仓位比例、止损止盈参数和技术指标参数
3. WHEN 用户提交策略配置 THEN 系统应调用 `/strategy/add` API创建策略，并提供参数验证和错误提示
4. WHEN 策略运行时 THEN 系统应通过 `/strategy/performance` API显示策略性能指标（信号生成数量、成功交易数、总盈亏等）
5. WHEN 用户查看策略详情 THEN 系统应显示策略配置参数、运行状态、历史表现和风险指标
6. WHEN 策略出现异常 THEN 系统应通过API响应显示错误信息和建议解决方案
7. WHEN 用户需要策略对比 THEN 系统应支持多策略性能对比和可视化展示

### 需求3：实时数据监控

**用户故事：** 作为交易员，我希望能够实时监控市场数据和交易信号，以便及时了解市场动态和系统响应。

#### 验收标准

1. WHEN 用户访问数据监控页面 THEN 系统应调用 `/data/market/{symbol}` API显示实时股票价格、成交量等市场数据
2. WHEN 有新的交易信号产生 THEN 系统应通过 `/strategy/performance` API实时显示信号详情（股票、类型、价格、数量）
3. WHEN 用户选择特定股票 THEN 系统应调用 `/data/market/{symbol}` API获取历史数据并显示K线图和技术指标
4. WHEN 系统处理tick数据 THEN 界面应通过 `/data/tick` API提交数据并显示处理状态和统计信息
5. WHEN 市场状态变化时 THEN 系统应通过 `/metrics` API显示当前交易时段和市场开闭状态
6. WHEN 用户查看历史数据 THEN 系统应支持时间范围参数调用API并提供数据导出功能
7. WHEN 用户需要实时数据流 THEN 系统应支持WebSocket连接或定时轮询API获取最新数据

### 需求4：订单和执行管理

**用户故事：** 作为交易管理员，我希望能够监控和管理所有订单的执行情况，以便确保交易按预期进行。

#### 验收标准

1. WHEN 用户访问订单页面 THEN 系统应通过 `/metrics` API显示所有订单的实时状态列表和执行统计
2. WHEN 有新订单创建 THEN 系统应通过 `/order/status/{order_id}` API实时更新订单列表并显示订单详情
3. WHEN 用户手动创建订单 THEN 系统应提供订单表单（股票代码、买卖方向、数量、价格、订单类型）并调用 `/order/create` API
4. WHEN 订单状态变化 THEN 系统应通过 `/order/status/{order_id}` API实时更新显示（待处理、已执行、已拒绝、错误）
5. WHEN 用户查看订单历史 THEN 系统应提供筛选、排序和搜索功能，基于API返回的订单数据
6. WHEN 订单执行失败 THEN 系统应通过API响应显示失败原因和错误详情
7. WHEN 用户需要订单统计 THEN 系统应显示订单创建数、成功率、执行延迟等关键指标

### 需求5：投资组合分析

**用户故事：** 作为投资分析师，我希望能够查看详细的投资组合分析报告，以便评估投资表现和风险状况。

#### 验收标准

1. WHEN 用户访问投资组合页面 THEN 系统应调用 `/portfolio/summary` API显示当前持仓详情、总价值、现金余额和持仓数量
2. WHEN 用户查看收益分析 THEN 系统应调用 `/analytics/performance` API显示收益率曲线、夏普比率、最大回撤等关键指标
3. WHEN 用户选择时间范围 THEN 系统应通过API参数更新相应时期的分析数据和图表
4. WHEN 用户查看风险指标 THEN 系统应调用 `/risk/metrics` API显示日盈亏、当前回撤、风险利用率等风险度量
5. WHEN 用户需要详细分析 THEN 系统应显示投资组合价值历史、未实现盈亏和持仓分布
6. WHEN 用户导出报告 THEN 系统应基于API数据生成PDF或Excel格式的详细分析报告
7. WHEN 投资组合有重大变化 THEN 系统应通过实时API监控发送通知并更新分析结果

### 需求6：风险监控和告警

**用户故事：** 作为风险管理员，我希望能够实时监控系统风险状况，以便及时发现和处理风险事件。

#### 验收标准

1. WHEN 用户访问风险页面 THEN 系统应调用 `/risk/metrics` API显示实时风险指标仪表板（日盈亏、当前回撤、风险限制、风险利用率）
2. WHEN 风险指标超过阈值 THEN 系统应基于API数据显示红色告警并发送通知（日损失超限、回撤超限）
3. WHEN 用户查看风险配置 THEN 系统应显示最大仓位比例、最大回撤限制、最大日损失等风险参数
4. WHEN 系统检测到异常交易 THEN 界面应通过 `/metrics` API显示异常详情和系统状态
5. WHEN 用户查看风险历史 THEN 系统应基于API数据提供风险事件时间线和详细记录
6. WHEN 达到风险限制 THEN 系统应显示风险检查结果和自动阻止状态
7. WHEN 用户需要风险控制 THEN 系统应提供 `/system/stop` 紧急停止操作

### 需求7：回测和模拟交易

**用户故事：** 作为策略研究员，我希望能够通过Web界面进行策略回测和模拟交易，以便验证策略有效性。

#### 验收标准

1. WHEN 用户启动回测 THEN 系统应提供策略选择、时间范围和参数配置界面，基于系统内置的回测引擎
2. WHEN 回测运行时 THEN 系统应通过 `/analytics/performance` API显示实时进度和中间结果
3. WHEN 回测完成 THEN 系统应调用 `/analytics/performance` API显示详细的回测报告和性能图表（总收益率、夏普比率、最大回撤、胜率等）
4. WHEN 用户比较策略 THEN 系统应支持多策略回测结果对比，基于 `/strategy/performance` API数据
5. WHEN 用户保存回测 THEN 系统应提供结果保存和历史查看功能，利用系统的持久化能力
6. WHEN 用户进行模拟交易 THEN 系统应通过演示模式提供虚拟资金环境和实时模拟
7. WHEN 模拟交易结束 THEN 系统应基于 `/analytics/performance` API生成模拟交易报告和学习建议

### 需求8：系统配置和管理

**用户故事：** 作为系统管理员，我希望能够通过Web界面管理系统配置和监控系统运行状态，以便确保系统稳定运行。

#### 验收标准

1. WHEN 用户访问系统管理页面 THEN 系统应调用 `/health` 和 `/metrics` API显示所有6个模块的详细状态信息和运行时间
2. WHEN 用户查看系统配置 THEN 系统应显示当前配置参数（初始资金、佣金率、风险限制、性能参数等）
3. WHEN 用户启动/停止系统 THEN 界面应提供 `/system/start` 和 `/system/stop` 控制按钮和状态反馈
4. WHEN 系统出现异常 THEN 管理界面应通过 `/health` API显示详细的错误信息和诊断状态
5. WHEN 用户查看系统指标 THEN 系统应通过 `/metrics` API显示性能统计、缓存命中率、内存使用等信息
6. WHEN 用户需要系统信息 THEN 系统应显示版本信息、运行时间、模块数量和API文档链接
7. WHEN 用户监控系统性能 THEN 界面应显示CPU使用率、内存使用、API响应时间等关键指标

## 非功能性需求

### 性能需求

1. 页面加载时间应在3秒内完成
2. 实时数据更新延迟应小于1秒
3. 支持并发用户数不少于10个
4. 图表渲染应流畅，支持大数据量显示

### 兼容性需求

1. 支持Chrome、Firefox、Safari、Edge等主流浏览器
2. 支持桌面端和平板设备访问
3. 响应式设计，适配不同屏幕尺寸

### 安全性需求

1. 用户身份认证和权限控制
2. API接口安全防护
3. 敏感数据加密传输
4. 操作日志记录和审计

### 可用性需求

1. 界面设计直观易用，符合用户习惯
2. 提供操作帮助和文档
3. 错误信息清晰明确
4. 支持键盘快捷键操作

## 技术约束

1. 前端框架：React 18+ 或 Vue 3+
2. UI组件库：Ant Design 或 Element Plus
3. 图表库：ECharts 或 Chart.js
4. 实时通信：WebSocket
5. 状态管理：Redux/Zustand 或 Pinia
6. 构建工具：Vite 或 Webpack
7. 后端API：基于现有FastAPI接口

## 验收标准

1. 所有功能模块正常工作，无阻塞性bug
2. 界面响应速度满足性能要求
3. 通过用户体验测试和反馈
4. 代码质量符合团队标准
5. 部署文档完整，易于维护